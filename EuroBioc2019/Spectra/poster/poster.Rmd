---
title: "Flexible Infrastructure for Mass Spectrometry Data"
author:
  - name: Laurent Gatto
    affil: 1
    orcid: "0000-0002-1520-2268"
  - name: Johannes Rainer
    affil: 2
    orcid: "0000-0002-6977-7147"
  - name: Sebastian Gibb
    affil: 3
    orcid: "0000-0001-7406-4443"
affiliation:
  - num: 1
    address: Computational Biology and Bioinformatics Group, de Duve Institute, UCLouvain
  - num: 2
    address: Institute for Biomedicine, Eurac Research
  - num: 3
    address: Department of Anaesthesiology and Intensive Care, University Medicine Greifswald
poster_width: "841mm"
poster_height: "1189mm"
column_numbers: 2
logoleft_name: https&#58;//raw.githubusercontent.com/rformassspectrometry/stickers/master/Spectra/Spectra.png
logoright_name: https&#58;//raw.githubusercontent.com/rformassspectrometry/stickers/master/logo/R4MassSpec-logo.png
bibliography:
  - rpackages.bib
link-citations: true
csl: nature.csl
output:
  posterdown::posterdown_html:
    self_contained: false
---

```{r environment, results = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
Sys.setenv(LANGUAGE = "en")
library("Spectra")

# BiocManager::install("rformassspectrometry/MsBackendHmdb")
library("MsBackendHmdb")

# sudo su apt install mono-devel nuget
# BiocManager::install("cpanse/MsBackendRawFileReader@Bioc3.10")
library("MsBackendRawFileReader")

bkdPkgs <- c("Spectra", "MsBackendHmdb", "MsBackendRawFileReader")
```

```{r citations, results = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
packagesToCite <- bkdPkgs
bib <- unlist(lapply(packagesToCite, function(x)toBibtex(citation(x))))
bib[grepl("Manual\\{", bib)] <- paste0("@Manual{", packagesToCite, ",")
writeLines(bib, "rpackages.bib")
```

```{r pkgcontent, echo = FALSE, message = FALSE, warning = FALSE}
pkgContent <- lapply(paste0("package:", bkdPkgs), function(pkg) {
    content <- ls(pkg)
    content[grep("MsBackend.+", content)]
})
names(pkgContent) <- bkdPkgs
backendClassNames <- unlist(pkgContent)
backendClasses <- lapply(backendClassNames, new)
```

# Introduction

## Mass Spectrometry (MS) Data

- Paired measurements:
    - intensity (counts) vs *m/z* (mass-to-charge ratio).
    - intensity vs retention time.

- Additional various metatdata.

## Problems

- Vendor-specific, closed file formats.
- Various open-formats, e.g. mzML, mzXML, mz5, CDF, MGF, CSV
- Spectra libraries/Annotation information in databases, e.g. SQL
- Multiple R-packages require different file formats and/or data structures.

## Solution

`Spectra` offers a common, flexible data structure and interface.

# Data Structure

```{r backendtable, echo = FALSE}
classTbl <- data.frame(
    class = paste0(backendClassNames,
        "[@", gsub("[^A-z]", "", names(backendClassNames)), "]"
    ),
    storage = ifelse(
        grepl("DataFrame", backendClassNames), "in-memory", "on-disk"
    ),
    writeable = ifelse(!sapply(backendClasses, isReadOnly), "yes", "no")
)

knitr::kable(classTbl, row.names = FALSE)
```

# Interface

[@Spectra]

[@MsBackendRawFileReader]

# Contact

[rformassspectrometry/Spectra](https://github.com/rformassspectrometry/Spectra)

# References
